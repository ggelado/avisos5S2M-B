---
layout: default
title: "Avisos 5S2M-B"
---
<h1>Últimos avisos</h1>

<ul>
{% assign now = 'now' | date: "%s" %}
{% for post in site.posts %}
  {% assign post_expires = post.expires | date: "%s" %}
  {% if post_expires == nil or post_expires > now %}
    <li>
      <a href="{{ site.baseurl }}{{ post.url }}?utm_source=web&utm_medium=link&utm_campaign=avisos">{{ post.title }}</a>
({{ post.date | date: "%d %B %Y" }}{% if post.expires %} - Vigente hasta: {{ post.expires | date: "%d %B %Y"}}{% endif %})
    </li>
  {% endif %}
{% endfor %}
</ul>

<p>Recuerda que esta web se actualiza regularmente. Puedes suscribirte al <a href="{{ site.baseurl }}/feed.xml">feed RSS</a> para recibir las últimas noticias directamente en tu lector de RSS.</p>
<p style="background-color: #fff3cd; color: #856404; padding: 15px; border-radius: 8px; border: 1px solid #ffeeba; font-weight: bold; font-size: 1.1em;">
  Nuevo sistema de notificaciones push 
  <a href="https://notifierpushrss.onrender.com/" target="_blank" rel="noopener noreferrer" style="color: #0056b3; font-weight: bold;">Accede aquí</a>.
</p>


<p>Enlaces de utilidad:</p>
<a href="https://stats.uptimerobot.com/OuKYf98R4h" target="_blank" rel="noopener noreferrer">
  Estado de los principales servicios
</a>

<a href="https://crtm.es/comunicacion/actualidad-del-servicio/avisos/informacion-actualizada?lang=es" target="_blank" rel="noopener noreferrer">
  Estado del Transporte Público
</a>

<div style="
  max-width: 420px;
  margin: 20px auto;
  padding: 12px;
  background: #f8f9fa;
  border: 1px solid #e0e0e0;
  border-radius: 10px;
  font-family: sans-serif;
  font-size: 0.9em;
">

  <div style="margin-bottom: 10px;">
    <div style="
      margin-top: 6px;
      border-radius: 8px;
      overflow: hidden;
      border: 1px solid #ddd;
      height: 160px;
    ">
      <iframe
        title="El tiempo AEMET"
        src="https://www.aemet.es/es/eltiempo/prediccion/municipios/mostrarwidget/boadilla-del-monte-id28022?w=g2p101010011ovmffffffx4f86d9t95b6e9r0s8n1"
        style="width:100%; height:100%; border:0;"
        scrolling="no"
        loading="lazy">
      </iframe>
    </div>
  </div>

  <div>
    <div style="
      margin-top: 6px;
      padding: 6px;
      background: white;
      border-radius: 8px;
      border: 1px solid #ddd;
      max-height: 140px;
      overflow-y: auto;
    ">
      <div id="estado-crtm">Cargando estado del servicio…</div>
    </div>
  </div>

</div>



<p>>Si quieres publicar un aviso accede a <a href="https://forms.office.com/e/qCSp3qmVCL">https://forms.office.com/e/qCSp3qmVCL</a></p

<!-- Modal de descarga de la app -->
<div id="download-app-modal" style="
    display:none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(2px);
    z-index: 9999;
">
  <div style="
        background:white;
        width: 80%;
        max-width: 350px;
        margin: 15% auto;
        padding: 20px;
        border-radius: 10px;
        text-align:center;
    ">

    <h3>Activa las notificaciones en tu navegador</h3>
    <p>Y podrás recibir avisos en cuanto se publiquen.</p>
    <p>La web puede tardar unos segundos en cargar.</p>
    <p>Recuerda pulsar "SUSCRIBIRME" y dar permiso a las notificaciones.</p>

    <!-- Botón universal -->
    <a id="universal-link" href="https://notifierpushrss.onrender.com/"
       style="margin: 15px 0; background:#4A90E2; color:white; padding:10px; border-radius:5px; text-decoration:none; display:block;">
       Activar notificaciones
    </a>

    <button id="close-modal" style="padding:8px 20px; border:none; background:#ccc; border-radius:5px;">
      Cerrar
    </button>
  </div>
</div>

{% raw %}
<script>
// Evitar mostrar el modal más de una vez
const shown = localStorage.getItem("appModalShown");

if (!shown) {
    document.getElementById("download-app-modal").style.display = "block";
}

// Cerrar el modal
document.getElementById("close-modal").onclick = function () {
    localStorage.setItem("appModalShown", "true");
    document.getElementById("download-app-modal").style.display = "none";
};
</script>
<script>
async function cargarEstadoCRTM() {
  const contenedor = document.getElementById("estado-crtm");
  if (!contenedor) return;

  const urlCRTM =
    "https://crtm.es/comunicacion/actualidad-del-servicio/avisos/informacion-actualizada?lang=es";

  const proxyURL =
    "https://corsproxy.io/?url=" + encodeURIComponent(urlCRTM);

  try {
    const response = await fetch(proxyURL);
    const html = await response.text();

    const parser = new DOMParser();
    const doc = parser.parseFromString(html, "text/html");

    const selector =
      "#colCentro > div > div.brdGris2 > div.cont > div:nth-child(2)";

    const divCRTM = doc.querySelector(selector);

    if (!divCRTM) {
      contenedor.innerText = "No se pudo obtener el estado del servicio";
      return;
    }

    // Clonamos para no mover nodos del documento remoto
    const clon = divCRTM.cloneNode(true);

    // Corregir rutas relativas de imágenes
    clon.querySelectorAll("img").forEach(img => {
      const src = img.getAttribute("src");
      if (src && src.trim().startsWith("/")) {
        img.src = "https://crtm.es" + src.trim();
      }
    });

    // Corregir rutas relativas de enlaces
    clon.querySelectorAll("a").forEach(a => {
      let href = a.getAttribute("href");
      if (!href) return;

      href = href.trim(); // elimina espacios y saltos de línea

      if (href.startsWith("/")) {
        a.href = "https://crtm.es" + href;
        a.target = "_blank";
        a.rel = "noopener noreferrer";
      }
    });

    // Limpiar y agregar el contenido
    contenedor.innerHTML = "";
    contenedor.appendChild(clon);

  } catch (err) {
    console.error("Error CRTM:", err);
    contenedor.innerText = "Error al cargar información del servicio";
  }
}

// Cargar al iniciar
document.addEventListener("DOMContentLoaded", cargarEstadoCRTM);

// Auto-refresh cada 5 minutos
setInterval(cargarEstadoCRTM, 5 * 60 * 1000);
</script>



{% endraw %}





